<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>V√≤ng quay may m·∫Øn</title>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #1f2937;
      --panel-2: #111827;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --accent: #0ea5e9;
      --btn: #334155;
      --btn-hover: #475569;
      --success: #059669;
      --danger: #dc2626;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    header {
      padding: 1rem;
      border-bottom: 1px solid #0b1220;
    }
    
    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }
    
    h1 {
      font-size: 1.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .container {
      max-width: 1200px;
      margin: 1rem auto;
      padding: 0 1rem;
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    
    @media (min-width: 1024px) {
      .container {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .card {
      background: color-mix(in srgb, var(--panel) 60%, transparent);
      border: 1px solid #0b1220;
      border-radius: 1rem;
      padding: 1rem;
      display: flex;
      flex-direction: column;
    }
    
    .wheel-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }
    
    .wheel-wrapper {
      position: relative;
      width: 100%;
      max-width: 500px;
      aspect-ratio: 1/1;
    }
    
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    
    .arrow {
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      width: 60px;
      height: 80px;
    }
    
    .result-area {
      width: 100%;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
    }
    
    .btn {
      background: var(--btn);
      color: var(--text);
      border: 1px solid #0b1220;
      border-radius: 0.75rem;
      padding: 0.625rem 0.875rem;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    .btn:hover {
      background: var(--btn-hover);
    }
    
    .btn-primary {
      background: var(--success);
    }
    
    .btn-primary:hover {
      background: #10b981;
    }
    
    .btn-danger {
      background: var(--danger);
    }
    
    .btn-danger:hover {
      background: #ef4444;
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    textarea, input, select {
      width: 100%;
      background: var(--panel-2);
      color: var(--text);
      border: 1px solid #0b1220;
      border-radius: 0.75rem;
      padding: 0.625rem;
      font-family: inherit;
      font-size: 1rem;
    }
    
    textarea {
      min-height: 300px;
      resize: vertical;
    }
    
    .input-group {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }
    
    .text-muted {
      color: var(--muted);
      font-size: 0.875rem;
    }
    
    .text-bold {
      font-weight: 700;
    }
    
    .flex {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    
    .flex-wrap {
      flex-wrap: wrap;
    }
    
    .justify-between {
      justify-content: space-between;
    }
    
    .grid {
      display: grid;
      gap: 0.75rem;
    }
    
    .grid-cols-2 {
      grid-template-columns: 1fr 1fr;
    }
    
    .result-box {
      background: var(--panel-2);
      border: 1px solid #0b1220;
      border-radius: 0.75rem;
      padding: 0.625rem;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.875rem;
    }
    
    th, td {
      padding: 0.5rem;
      border-bottom: 1px solid #0b1220;
      text-align: left;
    }
    
    thead {
      background: var(--panel-2);
      position: sticky;
      top: 0;
    }
    
    .history-container {
      max-height: 260px;
      overflow: auto;
      border: 1px solid #0b1220;
      border-radius: 0.75rem;
    }
    
    kbd {
      background: #334155;
      border-radius: 0.375rem;
      padding: 0.125rem 0.25rem;
      font-size: 0.875rem;
      font-family: monospace;
    }
    
    footer {
      text-align: center;
      padding: 1.5rem;
      margin-top: auto;
      color: var(--muted);
      font-size: 0.875rem;
    }
    
    /* Animation for winner */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .winner {
      animation: pulse 0.5s ease-in-out infinite;
      color: #fbbf24;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <h1><span>üéØ</span> V√≤ng quay may m·∫Øn</h1>
      <div class="text-muted">B·∫•m v√†o v√≤ng quay ho·∫∑c <kbd>Ctrl</kbd>+<kbd>Enter</kbd> ƒë·ªÉ quay</div>
    </div>
  </header>

  <main class="container">
    <!-- Left: Wheel -->
    <section class="card">
      <div class="wheel-container">
        <div class="wheel-wrapper">
          <canvas id="arrowCanvas" class="arrow"></canvas>
          <canvas id="wheelCanvas"></canvas>
        </div>
        
        <div class="result-area">
          <button id="spinBtn" class="btn btn-primary">
            <span>Quay (Ctrl+Enter)</span>
          </button>
          <div class="result-box">
            <div class="text-muted">K·∫øt qu·∫£</div>
            <div id="resultText" class="text-bold">‚Äî</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Right: Configuration -->
    <section class="card">
      <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
        <!-- Left column: Player list -->
        <div class="grid">
          <div class="input-group">
            <label class="text-muted">Danh s√°ch ng∆∞·ªùi ch∆°i (m·ªói d√≤ng 1 t√™n)</label>
            <textarea id="listInput" placeholder="D√°n t·ª´ Excel/Sheets ho·∫∑c nh·∫≠p th·ªß c√¥ng...">Gbriel
Lisa</textarea>
          </div>
          
          <div class="flex justify-between">
            <div class="text-muted">ƒê√£ lo·∫°i tr√πng: <b id="dedupCount">0</b></div>
            <div class="text-muted">T·ªïng ng∆∞·ªùi ch∆°i: <b id="totalCount">2</b></div>
          </div>
          
          <div class="flex flex-wrap">
            <button id="shuffleBtn" class="btn">
              <span>X√°o tr·ªôn</span>
            </button>
            <button id="sortBtn" class="btn">
              <span>S·∫Øp x·∫øp A‚ÜíZ</span>
            </button>
            <button id="newBtn" class="btn btn-danger">
              <span>M·ªõi</span>
            </button>
            <button id="csvBtn" class="btn" style="margin-left: auto;">
              <span>Xu·∫•t CSV</span>
            </button>
          </div>
        </div>
        
        <!-- Right column: Settings -->
        <div class="grid">
          <div class="input-group">
            <label class="text-muted">Th·ªùi gian quay: <b id="secLabel">10</b> gi√¢y</label>
            <input id="secRange" type="range" min="5" max="30" value="10" step="1" />
          </div>
          
          <div class="grid-cols-2" style="gap: 0.75rem;">
            <div class="input-group">
              <label class="text-muted">Ch·∫ø ƒë·ªô quay</label>
              <select id="modeSel">
                <option value="slow">Ch·∫≠m</option>
                <option value="normal" selected>B√¨nh th∆∞·ªùng</option>
                <option value="fast">Nhanh</option>
              </select>
            </div>
            
            <div class="input-group">
              <label class="text-muted">S·ªë m√†u</label>
              <select id="paletteSel">
                <option value="4" selected>4</option>
                <option value="6">6</option>
                <option value="8">8</option>
              </select>
            </div>
          </div>
          
          <div class="flex">
            <input id="removeChk" type="checkbox" checked />
            <label for="removeChk" class="text-muted">Lo·∫°i b·ªè ng∆∞·ªùi tr√∫ng kh·ªèi c√°c l·∫ßn quay sau (t·ª± ƒë·ªông xo√° sau 5s)</label>
          </div>
          
          <div>
            <h3 style="margin: 0.5rem 0;">L·ªãch s·ª≠ tr√∫ng</h3>
            <div class="history-container">
              <table>
                <thead>
                  <tr>
                    <th>Th·ªùi gian</th>
                    <th>Ng∆∞·ªùi tr√∫ng</th>
                    <th>Th·ªùi l∆∞·ª£ng</th>
                    <th>S·ªë c√≤n l·∫°i</th>
                  </tr>
                </thead>
                <tbody id="historyBody"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    ¬© <span id="year"></span> ‚Äì V√≤ng quay may m·∫Øn ‚Ä¢ Giao di·ªán ti·∫øng Vi·ªát
  </footer>

  <script>
    // ======= Color Palettes =======
    const PALETTES = {
      4: ["#f97316", "#22c55e", "#3b82f6", "#eab308"],
      6: ["#ef4444", "#f97316", "#eab308", "#22c55e", "#06b6d4", "#8b5cf6"],
      8: ["#ef4444", "#f97316", "#eab308", "#84cc16", "#22c55e", "#14b8a6", "#3b82f6", "#8b5cf6"],
    };

    // ======= App State =======
    let names = ["Gbriel", "Lisa"]; // Max 1000 names
    let paletteSize = 4;
    let spinSeconds = 10;
    let spinMode = "normal"; // slow/normal/fast
    let removeWinner = true;

    let resultText = "";
    let history = [];

    // Canvas elements
    const wheelCanvas = document.getElementById('wheelCanvas');
    const arrowCanvas = document.getElementById('arrowCanvas');
    const ctx = wheelCanvas.getContext('2d');
    const actx = arrowCanvas.getContext('2d');

    // Spin state
    let isSpinning = false;
    let angle = 0; // radians
    let rafId = null;
    let startTime = 0;
    let totalSpinMs = spinSeconds * 1000;
    let startAngle = 0;
    let targetAngle = 0;

    // DOM elements
    const listInput = document.getElementById('listInput');
    const dedupCountEl = document.getElementById('dedupCount');
    const totalCountEl = document.getElementById('totalCount');
    const secLabel = document.getElementById('secLabel');
    const secRange = document.getElementById('secRange');
    const modeSel = document.getElementById('modeSel');
    const paletteSel = document.getElementById('paletteSel');
    const removeChk = document.getElementById('removeChk');
    const resultEl = document.getElementById('resultText');
    const spinBtn = document.getElementById('spinBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const sortBtn = document.getElementById('sortBtn');
    const newBtn = document.getElementById('newBtn');
    const csvBtn = document.getElementById('csvBtn');
    const historyBody = document.getElementById('historyBody');

    // Initialize year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // ======= Helper Functions =======
    function sanitizeNames(raw) {
      const lines = raw.split(/\r?\n/).map(s => s.trim()).filter(Boolean);
      const seen = new Set();
      const unique = [];
      
      for (const name of lines) {
        const key = name.toLocaleLowerCase();
        if (!seen.has(key)) {
          seen.add(key);
          unique.push(name);
        }
      }
      
      return unique.slice(0, 1000);
    }

    function updateListFromTextarea() {
      const rawLines = listInput.value.split(/\r?\n/).map(s => s.trim()).filter(Boolean);
      const unique = sanitizeNames(listInput.value);
      
      names = unique;
      dedupCountEl.textContent = Math.max(0, rawLines.length - unique.length);
      totalCountEl.textContent = names.length;
      
      drawWheel();
    }

    function downloadCSV(filename, rows) {
      const header = ["Th·ªùi gian", "Ng∆∞·ªùi tr√∫ng", "Th·ªùi l∆∞·ª£ng (s)", "S·ªë c√≤n l·∫°i"];
      const lines = [header.join(',')].concat(
        rows.map(r => [
          r.time,
          r.winner.replaceAll(',', ' '),
          String(r.duration),
          String(r.remaining)
        ].join(','))
      );
      
      const blob = new Blob(["\uFEFF" + lines.join('\n')], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // ======= Sound Effects =======
    class SoundKit {
      constructor() {
        this.ctx = null;
        this.master = null;
      }
      
      ensure() {
        if (!this.ctx) {
          this.ctx = new (window.AudioContext || window.webkitAudioContext)();
          this.master = this.ctx.createGain();
          this.master.gain.value = 0.2;
          this.master.connect(this.ctx.destination);
        }
      }
      
      tick() {
        this.ensure();
        const c = this.ctx;
        const osc = c.createOscillator();
        const g = c.createGain();
        
        osc.type = 'square';
        osc.frequency.value = 800 + Math.random() * 200;
        
        g.gain.setValueAtTime(0.0001, c.currentTime);
        g.gain.exponentialRampToValueAtTime(0.3, c.currentTime + 0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, c.currentTime + 0.09);
        
        osc.connect(g).connect(this.master);
        osc.start();
        osc.stop(c.currentTime + 0.1);
      }
      
      fanfare(duration = 1.8) {
        this.ensure();
        const c = this.ctx;
        const root = 392;
        const freqs = [root, root * 1.25, root * 1.5, root * 2];
        
        freqs.forEach((f, i) => {
          const o = c.createOscillator();
          const g = c.createGain();
          
          o.type = 'sawtooth';
          o.frequency.setValueAtTime(f, c.currentTime + i * 0.05);
          
          g.gain.setValueAtTime(0.0001, c.currentTime);
          g.gain.exponentialRampToValueAtTime(0.35, c.currentTime + 0.05 + i * 0.05);
          g.gain.exponentialRampToValueAtTime(0.0001, c.currentTime + duration);
          
          o.connect(g).connect(this.master);
          o.start();
          o.stop(c.currentTime + duration + 0.1);
        });
        
        return new Promise(res => setTimeout(res, duration * 1000));
      }
      
      deleteBeep() {
        this.ensure();
        const c = this.ctx;
        const o = c.createOscillator();
        const g = c.createGain();
        
        o.type = 'triangle';
        o.frequency.value = 600;
        
        g.gain.setValueAtTime(0.0001, c.currentTime);
        g.gain.exponentialRampToValueAtTime(0.3, c.currentTime + 0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, c.currentTime + 0.4);
        
        o.connect(g).connect(this.master);
        o.start();
        o.stop(c.currentTime + 0.5);
      }
    }
    
    const sound = new SoundKit();

    // ======= Arrow Drawing =======
    function drawArrow() {
      const dpr = window.devicePixelRatio || 1;
      const w = 60, h = 80;
      
      arrowCanvas.width = w * dpr;
      arrowCanvas.height = h * dpr;
      arrowCanvas.style.width = w + 'px';
      arrowCanvas.style.height = h + 'px';
      
      actx.setTransform(1, 0, 0, 1, 0, 0);
      actx.scale(dpr, dpr);
      actx.clearRect(0, 0, w, h);
      
      // Draw arrow shape
      actx.beginPath();
      actx.moveTo(w / 2, 0);
      actx.lineTo(w / 2 - 18, 40);
      actx.lineTo(w / 2 + 18, 40);
      actx.closePath();
      
      actx.fillStyle = '#f59e0b';
      actx.fill();
      
      actx.lineWidth = 3;
      actx.strokeStyle = '#78350f';
      actx.stroke();
    }

    // ======= Wheel Drawing =======
    function drawWheel() {
      const dpr = window.devicePixelRatio || 1;
      const size = Math.min(window.innerWidth, 500);
      
      wheelCanvas.width = size * dpr;
      wheelCanvas.height = size * dpr;
      wheelCanvas.style.width = size + 'px';
      wheelCanvas.style.height = size + 'px';
      
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.scale(dpr, dpr);
      ctx.clearRect(0, 0, size, size);
      
      const r = size / 2 - 6;
      const cx = size / 2;
      const cy = size / 2;
      
      // Draw outer circle
      ctx.save();
      ctx.beginPath();
      ctx.arc(cx, cy, r + 4, 0, Math.PI * 2);
      ctx.fillStyle = '#111827';
      ctx.fill();
      ctx.restore();
      
      // Show message if not enough players
      if (names.length < 2) {
        ctx.fillStyle = '#e5e7eb';
        ctx.font = '16px system-ui, -apple-system, Segoe UI, Roboto';
        ctx.textAlign = 'center';
        ctx.fillText('C·∫ßn √≠t nh·∫•t 2 ng∆∞·ªùi ch∆°i', cx, cy);
        return;
      }
      
      const per = Math.PI * 2 / names.length;
      const baseAngle = angle;
      const palette = PALETTES[paletteSize];
      
      // Draw segments
      for (let i = 0; i < names.length; i++) {
        const start = baseAngle + i * per;
        const end = start + per;
        
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.arc(cx, cy, r, start, end);
        ctx.closePath();
        
        ctx.fillStyle = palette[i % palette.length];
        ctx.fill();
        
        ctx.strokeStyle = '#0f172a';
        ctx.lineWidth = 1;
        ctx.stroke();
        
        // Draw text
        const mid = (start + end) / 2;
        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(mid);
        
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = '#111827';
        
        const fontSize = Math.max(10, Math.min(20, 180 / Math.sqrt(names.length)));
        ctx.font = `${fontSize}px system-ui, -apple-system, Segoe UI, Roboto`;
        
        const textRadius = r * 0.65;
        ctx.fillText(names[i], textRadius, 0);
        ctx.restore();
      }
      
      // Draw outer border
      ctx.beginPath();
      ctx.arc(cx, cy, r, 0, Math.PI * 2);
      ctx.lineWidth = 4;
      ctx.strokeStyle = '#0ea5e9';
      ctx.stroke();
    }

    // ======= Spin Mechanics =======
    function easeOutCubic(t) {
      return 1 - Math.pow(1 - t, 3);
    }

    function getWinnerIndex() {
      const per = Math.PI * 2 / names.length;
      const a = angle % (Math.PI * 2);
      const arrowAngle = -Math.PI / 2;
      
      let rel = arrowAngle - a;
      rel = ((rel % (Math.PI * 2)) + Math.PI * 2) % (Math.PI * 2);
      
      return Math.floor(rel / per);
    }

    function finishSpin() {
      isSpinning = false;
      const idx = getWinnerIndex();
      const winner = names[idx];
      
      resultText = winner;
      resultEl.textContent = winner || '‚Äî';
      resultEl.classList.add('winner');
      
      // Add to history
      const rec = {
        time: new Date().toLocaleString(),
        winner,
        duration: Math.round(totalSpinMs / 1000),
        remaining: names.length
      };
      
      history.unshift(rec);
      renderHistory();
      
      // Play fanfare and optionally remove winner
      sound.fanfare()
        .then(() => new Promise(r => setTimeout(r, 5000)))
        .then(() => {
          resultEl.classList.remove('winner');
          
          if (removeWinner && winner) {
            names = names.filter((_, i) => i !== idx);
            const list = listInput.value.split(/\r?\n/)
              .map(s => s.trim())
              .filter(Boolean)
              .filter(n => n !== winner)
              .join('\n');
            
            listInput.value = list;
            updateListFromTextarea();
            sound.deleteBeep();
          }
        });
    }

    function tryStartSpin() {
      if (isSpinning) return;
      if (names.length < 2) {
        alert('C·∫ßn √≠t nh·∫•t 2 ng∆∞·ªùi ch∆°i.');
        return;
      }
      
      const seconds = Math.max(5, Math.min(30, spinSeconds));
      totalSpinMs = seconds * 1000;
      startTime = performance.now();
      startAngle = angle;
      
      const extraTurns = spinMode === 'fast' ? 10 : (spinMode === 'slow' ? 5 : 7);
      const randomOffset = Math.random() * Math.PI * 2;
      targetAngle = startAngle + extraTurns * Math.PI * 2 + randomOffset;
      
      isSpinning = true;
      if (rafId) cancelAnimationFrame(rafId);
      
      const loop = () => {
        const now = performance.now();
        const t = Math.min(1, (now - startTime) / totalSpinMs);
        const eased = easeOutCubic(t);
        
        angle = startAngle + (targetAngle - startAngle) * eased;
        
        // Play tick sound randomly
        if (Math.random() < (1 - t) * 0.8 + 0.1) {
          sound.tick();
        }
        
        drawWheel();
        
        if (t < 1) {
          rafId = requestAnimationFrame(loop);
        } else {
          finishSpin();
        }
      };
      
      rafId = requestAnimationFrame(loop);
    }

    function renderHistory() {
      historyBody.innerHTML = history.map(h => `
        <tr>
          <td>${h.time}</td>
          <td>${h.winner}</td>
          <td>${h.duration}s</td>
          <td>${h.remaining}</td>
        </tr>
      `).join('');
    }

    // ======= Event Listeners =======
    listInput.addEventListener('input', updateListFromTextarea);
    
    secRange.addEventListener('input', (e) => {
      spinSeconds = parseInt(e.target.value, 10);
      secLabel.textContent = spinSeconds;
    });
    
    modeSel.addEventListener('change', (e) => {
      spinMode = e.target.value;
    });
    
    paletteSel.addEventListener('change', (e) => {
      paletteSize = parseInt(e.target.value, 10);
      drawWheel();
    });
    
    removeChk.addEventListener('change', (e) => {
      removeWinner = e.target.checked;
    });
    
    spinBtn.addEventListener('click', tryStartSpin);
    
    shuffleBtn.addEventListener('click', () => {
      // Fisher-Yates shuffle
      for (let i = names.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [names[i], names[j]] = [names[j], names[i]];
      }
      
      listInput.value = names.join('\n');
      updateListFromTextarea();
    });
    
    sortBtn.addEventListener('click', () => {
      names.sort((a, b) => a.localeCompare(b));
      listInput.value = names.join('\n');
      updateListFromTextarea();
    });
    
    newBtn.addEventListener('click', () => {
      // Reset everything
      listInput.value = 'Gbriel\nLisa';
      spinSeconds = 10;
      secRange.value = '10';
      secLabel.textContent = '10';
      spinMode = 'normal';
      modeSel.value = 'normal';
      paletteSize = 4;
      paletteSel.value = '4';
      removeWinner = true;
      removeChk.checked = true;
      history = [];
      renderHistory();
      resultEl.textContent = '‚Äî';
      resultEl.classList.remove('winner');
      angle = 0;
      updateListFromTextarea();
    });
    
    csvBtn.addEventListener('click', () => {
      if (!history.length) {
        alert('Ch∆∞a c√≥ l·ªãch s·ª≠ tr√∫ng.');
        return;
      }
      downloadCSV('lich_su_trung.csv', [...history].reverse());
    });
    
    // Keyboard shortcut
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && e.ctrlKey) {
        e.preventDefault();
        tryStartSpin();
      }
    });
    
    // Handle window resize
    window.addEventListener('resize', () => {
      drawWheel();
      drawArrow();
    });
    
    // Click on wheel to spin
    wheelCanvas.addEventListener('click', tryStartSpin);

    // ======= Initialization =======
    drawArrow();
    updateListFromTextarea();
    drawWheel();
  </script>
</body>
</html>
